# ADR-0001: DevSafe Architecture & Core Decisions

Status: ACCEPTED  
Date: 2026-01-01  
Owner: Viktor Kulichenko  
Project: DevSafe GUI  
Related:
- 01_TZ.md
- 02_TESTS.md
- 03_SOLUTION.md

---

## 1. Context

В процессе активной разработки нескольких проектов была выявлена системная проблема:

- код может быть утерян из-за человеческого фактора
- Git используется нерегулярно
- локальные файлы уязвимы при сбоях ОС, IDE и дисков
- стандартные backup-механизмы не учитывают структуру проекта и Git

Требовалось создать **инструмент разработчика**, который:

- работает постоянно
- не требует дисциплины от пользователя
- автоматически сохраняет код
- легко восстанавливает проект

---

## 2. Decision

Принято решение разработать **DevSafe GUI** — desktop-приложение для Windows,
которое обеспечивает **двухконтурную защиту кода**:

1. Git (локальные коммиты + push в GitHub)
2. Локальный резерв проекта на отдельном диске

---

## 3. Key Architectural Decisions

### ADR-1.1 — Desktop GUI, а не CLI

**Решение:**  
Использовать desktop GUI (Tkinter).

**Причины:**
- инструмент работает постоянно
- пользователь видит состояние
- меньше вероятность ошибок
- проще включать/выключать защиту

**Альтернативы:**
- CLI + daemon — отклонено (низкая наглядность)
- IDE plugins — отклонено (vendor lock-in)

---

### ADR-1.2 — Single Active Project

**Решение:**  
Одновременно отслеживается **только 1 активный проект**.

**Причины:**
- снижение нагрузки
- упрощение архитектуры
- отсутствие race conditions
- реальный рабочий сценарий пользователя

**Альтернативы:**
- несколько активных проектов — отложено

---

### ADR-1.3 — Ограничение до 5 проектов

**Решение:**  
Максимум **5 проектов** в системе.

**Причины:**
- реальное когнитивное ограничение
- упрощение UX
- контроль сложности

---

### ADR-1.4 — File Watcher вместо таймера

**Решение:**  
Использовать file watcher для реакции на изменения файлов.

**Причины:**
- быстрее реакция
- меньше пустых проверок
- точнее контроль изменений

**Дополнение:**  
Используется debounce, чтобы избежать спама коммитами.

---

### ADR-1.5 — Git как журнал, а не как backup

**Решение:**  
Git используется для:
- истории
- версионирования
- off-site копии (GitHub)

Git **не используется** для хранения:
- бинарников
- моделей
- кешей

**Причины:**
- Git не предназначен для больших файлов
- чистая история
- быстрые операции

---

### ADR-1.6 — Локальный backup через mirror

**Решение:**  
Резервное копирование реализовано как **зеркалирование проекта** на другой диск.

**Причины:**
- мгновенное восстановление
- независимость от Git
- работает без интернета

**Альтернативы:**
- zip-архивы — отклонено (медленно, неудобно)
- облачные хранилища — вне scope

---

### ADR-1.7 — Уважение `.gitignore`

**Решение:**  
DevSafe строго уважает `.gitignore`.

**Причины:**
- безопасность
- отсутствие утечек секретов
- предсказуемость

---

### ADR-1.8 — Хранение конфигурации локально

**Решение:**  
Конфигурация хранится в локальном JSON-файле.

**Причины:**
- простота
- переносимость
- отсутствие зависимости от облака

---

## 4. Consequences

### Положительные:
- минимальный риск потери кода
- простота использования
- прозрачное поведение
- высокая надёжность

### Ограничения:
- Windows-only
- один активный проект
- нет шифрования резервов

---

## 5. Status & Review

- Статус: **ACCEPTED**
- Пересмотр:
  - при добавлении multi-project execution
  - при переходе к enterprise-версии

---

## 6. Summary

DevSafe — это не backup-утилита и не Git-обёртка.

Это:
> **Инженерный контур защиты кода**,  
> который устраняет человеческий фактор  
> и обеспечивает воспроизводимость разработки.

---
